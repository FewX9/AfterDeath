<!doctype html>
<html lang="en">
  <head>
    <title>AfterDeath Service | บริการจัดงานศพ</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" href="{{ url_for ('static', filename='css/backend.css') }}">
    <script src="{{ url_for ('static', filename='js/backend.js') }}"></script>
    <script src="https://kit.fontawesome.com/72ccea37af.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/js-cookie@3.0.1/dist/js.cookie.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>

    <!-- Bootstrap CSS v5.0.2 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"  integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  </head>
  
  <body>
    <div id="nav"></div>
    {%if msg == "cancle"%}
    <script>
      window.onload = function() {
        respon()
        nav()
        $('#ignismyModal').modal('show');
        setTimeout(function() {
          $("#ignismyModal").delay(1000).fadeOut();
          setTimeout(function() {$('#ignismyModal').modal('hide');},1400);
        }, 
        1000);
      }
    </script>
    <div class="modal fade" id="ignismyModal" role="dialog">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-body">
                      <div class="thank-you-pop">
                        <img src="http://goactionstations.co.uk/wp-content/uploads/2017/03/Green-Round-Tick.png" alt="">
                        <h1>สำเร็จ</h1>
                        <p>ระบบได้ยกเลิกออเดอร์เรียบร้อยแล้ว</p>
                      </div>     
                    </div>
                </div>
            </div>
        </div>
        {%elif msg == "delete"%}
        <script>
          window.onload = function() {
            respon()
            nav()
            $('#ignismyModal').modal('show');
            setTimeout(function() {
              $("#ignismyModal").delay(1000).fadeOut();
              setTimeout(function() {$('#ignismyModal').modal('hide');},1400);
            }, 
            1000);
          }
        </script>
        <div class="modal fade" id="ignismyModal" role="dialog">
          <div class="modal-dialog">
              <div class="modal-content">
                  <div class="modal-body">
                    <div class="thank-you-pop">
                        <img src="http://goactionstations.co.uk/wp-content/uploads/2017/03/Green-Round-Tick.png" alt="">
                        <h1>สำเร็จ</h1>
                        <p>ระบบได้ลบออเดอร์เรียบร้อยแล้ว</p>
                      </div>     
                    </div>
                  </div>
              </div>
          </div>
          {%elif msg == "confirm"%}
          <script>
            window.onload = function() {
              respon()
              nav()
              $('#ignismyModal').modal('show');
              setTimeout(function() {
                $("#ignismyModal").delay(1000).fadeOut();
                setTimeout(function() {$('#ignismyModal').modal('hide');},1400);
              }, 
              1000);
            }
          </script>
          <div class="modal fade" id="ignismyModal" role="dialog">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-body">
                      <div class="thank-you-pop">
                          <img src="http://goactionstations.co.uk/wp-content/uploads/2017/03/Green-Round-Tick.png" alt="">
                          <h1>สำเร็จ</h1>
                          <p>ระบบได้ยืนยันออเดอร์เรียบร้อยแล้ว</p>
                        </div>     
                      </div>
                    </div>
                </div>
            </div>
            {%elif msg == "success"%}
            <script>
              window.onload = function() {
                respon()
                nav()
                $('#ignismyModal').modal('show');
                setTimeout(function() {
                  $("#ignismyModal").delay(1000).fadeOut();
                  setTimeout(function() {$('#ignismyModal').modal('hide');},1400);
                }, 
                1000);
              }
            </script>
            <div class="modal fade" id="ignismyModal" role="dialog">
              <div class="modal-dialog">
                  <div class="modal-content">
                      <div class="modal-body">
                        <div class="thank-you-pop">
                            <img src="http://goactionstations.co.uk/wp-content/uploads/2017/03/Green-Round-Tick.png" alt="">
                            <h1>สำเร็จ</h1>
                            <p>ระบบได้ยืนยันการจัดส่งออเดอร์เรียบร้อยแล้ว</p>
                          </div>     
                        </div>
                      </div>
                  </div>
              </div>
    {%endif%}
    
    <div class="d-flex p-2 bd-highlight" style='margin-top:10px;'>

      <table class="table">
        <thead style="text-align:center">
          <tr>
            <th scope="col">วันที่เปิดออเดอร์</th>
            <th scope="col">ชื่อ-นามสกุล</th>
            <th scope="col">เบอร์โทร</th>
            <th scope="col">ที่อยู่</th>
            <th scope="col">ยอดรวม</th>
            <th scope="col">หลักฐารการโอน</th>
            <th scope="col">ชื่อผู้ส่ง</th>
            <th scope="col">เบอร์โทรผู้ส่ง</th>
            <th scope="col">สถานะคำสั่งซื้อ</th>
            <th scope="col">จัดการคำสั่งซื้อ</th>
          </tr>
        </thead>
        <tbody>
          {%for item in data%}
          <tr style='text-align:center; vertical-align:middle'>
            <td>{{item[5]}}</td>
            <td>{{item[1]}} {{item[2]}}</td>
            <td>{{item[3]}}</td>
            <td>{{item[11]}}</td>
            <td>{{item[4]}}</td>
            <td>
              {%if item[9] != 'cash'%}
              <img id="myImg" src="/static/img/slip/{{item[9]}}" style="width:100%;max-width:100px">

              <div id="myModal" class="modal" style="overflow: hidden;">
                <span class="close">&times;</span>
                <img class="modal-content" id="img01" style="width:100%;max-width:400px">
                <div id="caption"></div>
              </div>
              {%else%}
              ชำระเป็นเงินสด
              {%endif%}
            </td>
            <td>{{item[7]}}</td>
            <td>{{item[8]}}</td>
            <td>{{item[6]}}</td>
            <td>
              {%if item[6] == 'รอยืนยัน'%}
              <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                <button onclick="confirm_order('{{item[0]}}')" type="button" class="btn btn-success">ยืนยัน</button>
                <a href="/backend/cancle_order/{{item[0]}}" class="btn btn-danger">ยกเลิก</a>
              </div>
              {% elif item[6] == 'ยกเลิก' %}
              <div class="d-grid gap-2 d-md-flex justify-content-center">
                <a href="/backend/delete_order/{{item[0]}}" class="btn btn-danger">ลบรายการนี้</a>
              </div>
              {% elif item[6] == 'จัดส่งสำเร็จ' %}
              <div class="d-grid gap-2 d-md-flex justify-content-center">
                <a href="/backend/delete_order/{{item[0]}}" class="btn btn-danger">ลบข้อมูลรายการนี้</a>
              </div>
              {% else %}
              <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                <button onclick="show_item('{{item[10]}}')" class="btn btn-primary">รายการสินค้า</button>
                <a href="/backend/order_success/{{item[0]}}" class="btn btn-success">จัดส่งสำเร็จ</a>
                <a href="/backend/cancle_order/{{item[0]}}" class="btn btn-danger">ยกเลิก</a>
              </div>
              {%endif%}
            </td>
          </tr>
          {%endfor%}
        </tbody>
      </table>

    </div>

    <script>

      var modal = document.getElementById("myModal");
      
      var img = document.getElementById("myImg");
      var modalImg = document.getElementById("img01");
      var captionText = document.getElementById("caption");
      img.onclick = function(){
        modal.style.display = "block";
        modalImg.src = this.src;
        captionText.innerHTML = this.alt;
      }
      
      var span = document.getElementsByClassName("close")[0];
      
      span.onclick = function() { 
        modal.style.display = "none";
      }
      </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!-- Bootstrap JavaScript Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
  </body>
</html>